## 1. í”„ë¡œì íŠ¸ ìš”ì•½
ğŸš— Mamba ê¸°ë°˜ End-to-End ììœ¨ ì£¼ì°¨ ì‹œìŠ¤í…œ
CARLA ì‹œë®¬ë ˆì´í„° í™˜ê²½ì—ì„œ Mamba(State Space Model) ì•„í‚¤í…ì²˜ë¥¼ í™œìš©í•˜ì—¬ êµ¬í˜„í•œ íš¨ìœ¨ì ì¸ End-to-End ììœ¨ ì£¼ì°¨ ì—ì´ì „íŠ¸ì…ë‹ˆë‹¤.

ë³¸ í”„ë¡œì íŠ¸ëŠ” ê¸°ì¡´ì˜ Transformer êµ¬ì¡°ë³´ë‹¤ ì—°ì‚° íš¨ìœ¨ì´ ë›°ì–´ë‚œ Mamba(Selective State Space Model)ë¥¼ í™œìš©í•˜ì—¬ ì£¼í–‰ ì œì–´ ëª…ë ¹ì„ ì§ì ‘ ìƒì„±í•©ë‹ˆë‹¤. ë³µì¡í•œ ì£¼ì°¨ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì„¼ì„œ ë°ì´í„°ë¥¼ ì…ë ¥ë°›ì•„ ì¡°í–¥(Steering), ê°€ì†(Acceleration), ì œë™(Brake) ê°’ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì˜ˆì¸¡í•©ë‹ˆë‹¤.

ë³¸ ëª¨ë¸ì€ ë‹¤ì¤‘ ì„¼ì„œ ì •ë³´ë¥¼ í†µí•©í•˜ì—¬ ì •ë°€í•œ ì£¼ì°¨ ì œì–´ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ê³„ë³„ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

1. Multi-View Input (4 Surround Images): ì°¨ëŸ‰ ì£¼ë³€ì„ ê°ì‹œí•˜ëŠ” 4ê°œì˜ ì¹´ë©”ë¼(ì „/í›„/ì¢Œ/ìš°)ë¡œë¶€í„° ì›ì‹œ ë°ì´í„°ë¥¼ ì…ë ¥ë°›ìŠµë‹ˆë‹¤.

2. BEV Feature Extraction: ê° ì¹´ë©”ë¼ì˜ 2D ì´ë¯¸ì§€ë¥¼ ê³µê°„ ì§€ê°ë ¥ì´ ê·¹ëŒ€í™”ëœ BEV(Bird's-Eye View) íŠ¹ì§• ë§µìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì´ëŠ” ì£¼ì°¨ ì¹¸ê³¼ì˜ ê±°ë¦¬ ë° ì •ë ¬ ìƒíƒœë¥¼ íŒŒì•…í•˜ëŠ” ë° í•µì‹¬ì ì¸ ì—­í• ì„ í•©ë‹ˆë‹¤.

3. Feature Fusion: ì¶”ì¶œëœ ê° ë·°ì˜ íŠ¹ì§•ë“¤ì„ í•˜ë‚˜ì˜ í†µí•©ëœ ë²¡í„° ê³µê°„ìœ¼ë¡œ ìœµí•©(Fusion)í•˜ì—¬ ì°¨ëŸ‰ ì£¼ë³€ 360ë„ í™˜ê²½ì„ ë‹¨ì¼ ì§€í‘œë¡œ ì¬êµ¬ì„±í•©ë‹ˆë‹¤.

> [!IMPORTANT]
> ### 4. Mamba Sequence Modeling: ê³µê°„ ì§€ê°ê³¼ ì£¼í–‰ ë§¥ë½ì˜ í†µí•©
> íŠ¸ëœìŠ¤í¬ë¨¸ì— ì˜í•´ ìœµí•©ëœ íŠ¹ì§• ì‹œí€€ìŠ¤ë¥¼ **Mamba(SSM) ë¸”ë¡**ì— ì…ë ¥í•˜ì—¬ ì •êµí•œ ì‹œí€€ìŠ¤ ëª¨ë¸ë§ì„ ìˆ˜í–‰í•œë‹¤. 
> 
> * **ë³‘ë ¬ ì—°ì‚° ìµœì í™”:** `Associative Scan` ì›ë¦¬ë¥¼ ì´ìš©í•œ **ë³‘ë ¬ ìŠ¤ìº”(Parallel Scan)** ê¸°ë²•ì„ ì ìš©í•˜ì—¬ $O(\log L)$ì˜ ë³µì¡ë„ë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ ì—°ì‚° íš¨ìœ¨ì„ ê·¹ëŒ€í™”í•˜ì˜€ë‹¤.
> * **Simplified S6 ì„¤ê³„ ($B=C$):** ì…ë ¥ ê°€ì¤‘ì¹˜($B$)ì™€ ì¶œë ¥ ê°€ì¤‘ì¹˜($C$)ë¥¼ ê³µìœ í•˜ëŠ” êµ¬ì¡°ë¥¼ ì±„íƒí•˜ì—¬ íŒŒë¼ë¯¸í„°ë¥¼ íš¨ìœ¨í™”í•˜ê³ , ì£¼í–‰ ë§¥ë½ ì •ë³´ê°€ ì œì–´ ì‹ í˜¸ë¡œ ë³€í™˜ë  ë•Œì˜ **ì¼ê´€ì„±ê³¼ ì•ˆì •ì„±**ì„ í™•ë³´í•˜ì˜€ë‹¤.
> * **ë™ì  ë§¥ë½ ì¶”ì¶œ:** íŠ¸ëœìŠ¤í¬ë¨¸ê°€ í¬ì°©í•œ ì •ì  ê³µê°„ íŠ¹ì§•ìœ¼ë¡œë¶€í„° ì°¨ëŸ‰ì˜ ì´ë™ íë¦„ê³¼ ì£¼í–‰ ì´ë ¥ì„ ë°˜ì˜í•œ **ë™ì  ë§¥ë½(Driving Context)**ì„ ìƒì„±í•˜ì—¬ ìµœì¢… ì œì–´ í—¤ë“œì— ì „ë‹¬í•œë‹¤.

5. Control Prediction: ìµœì¢…ì ìœ¼ë¡œ Mambaì˜ ì¶œë ¥ê°’ì€ ì œì–´ í—¤ë“œë¥¼ ê±°ì³ ì¡°í–¥(Steering), ê°€ì†(Accel), ì œë™(Brake) ë“±ì˜ ë¬¼ë¦¬ì  ì œì–´ ì‹ í˜¸ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.

```mermaid
graph LR
    A[4-View Images] --> B[Transformer Fusion]
    B -- "Static Spatial Feature" --> C[Mamba Encoder]
    C -- "Dynamic Context (Parallel Scan)" --> D[Control Head]
    D --> E[Steer/Accel/Brake]
```

## 2. Requirement
carla: 0.9.11

python: 3.7


## 3. ê²°ê³¼

NVIDIA RTX 2080 GPU í™˜ê²½ì—ì„œ ì´ 30 Epoch ë™ì•ˆ ì•½ 60ì‹œê°„ì˜ í•™ìŠµì„ ì§„í–‰í•˜ì˜€ë‹¤.

ğŸ ì£¼ì°¨ ì„±ê³µ íŒì • ê¸°ì¤€ 


ì°¨ëŸ‰ì˜ ì¤‘ì‹¬ì´ ì£¼ì°¨ ì¹¸ì˜ ì •ì¤‘ì•™ìœ¼ë¡œë¶€í„° 0.5m ì´ë‚´ì— ìœ„ì¹˜í•´ì•¼ í•˜ë©°, ì°¨ì²´ê°€ ëª©í‘œ ë°©í–¥ì—ì„œ í‹€ì–´ì§„ ê°ë„ ì˜¤ì°¨ê°€ 0.5ë„ ë¯¸ë§Œì´ì–´ì•¼ í•œë‹¤.


<img width="500" height="350" alt="image" src="https://github.com/user-attachments/assets/296a3b91-9e6a-4e85-86ec-c1ec71a3e834" />
<img width="500" height="350" alt="image" src="https://github.com/user-attachments/assets/b4655293-d00f-4a7c-ac20-5e203925b05b" />


## 4. Dataset

https://pan.baidu.com/s/1PoMSfgZQMnUGlhi7S5fFZw?pwd=2ik6

pretrained model

last.ckpt êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë‹¤ìš´ë¡œë“œ


## 5. References

ë³¸ í”„ë¡œì íŠ¸ëŠ” ì•„ë˜ ë…¼ë¬¸ì˜ ì—°êµ¬ ì„±ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ êµ¬í˜„ ë° ê°œì„ ë˜ì—ˆìŠµë‹ˆë‹¤.

[E2E Parking: Autonomous Parking by the End-to-end Neural Network on the CARLA Simulator](https://ieeexplore.ieee.org/document/10588551)



